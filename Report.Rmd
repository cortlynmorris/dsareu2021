---
title: "Visualizing, Modeling and Forecasting Crashes in Wake County, North Carolina"
author: "Cortlyn Morris, Kelly Wentzlof, Ayan Gulzar"
date: "6/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Here we will be loading necessary packages.

```{r, message=FALSE, warning=FALSE}
library(reshape2)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(dslabs)
library(ggrepel)
library(ggthemes)
```

### Setting working directory.

```{r}
#setwd("/Users/cmorris/Desktop/dsreu2021/rstudiodirectory/ResearchProject")
```

### Reading and merging the data.

```{r}
persons <- read.csv(file="Persons_Involved_in_Crashes.csv")
glimpse(persons)

locations <- read.csv(file="Reported_Crash_Locations.csv")
glimpse(locations)

crashes <- persons %>% left_join(locations, by="key_crash")
```

## Exploratory data analysis using log transformed data.

### Frequency of crashes by vehicle type

The highest frequency of crashes occur in a passenger car. However, this is not very surprising because passenger cars are relatively common. An interesting note is that sport utility vehicles have the second highest frequency of crashes, however, sport utility vehicles are not nearly as common of a car.

```{r}
crashes %>% 
  filter(VehicleType != "Unknown", VehicleType != "") %>%
  count(VehicleType) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         VehicleType = reorder(VehicleType,logtrans)) %>% 
  ggplot(aes(x=VehicleType, y=logtrans, fill=VehicleType)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) + 
  labs(title = "Frequency of Crashes by Vehicle Type", 
       x = "Vehicle Type", 
       y = "Count (log10 Scale)")
```

### Frequency of crashes by weather condition.

The highest frequency of crashes occur when the weather conditions are clear. This is not very surprising because in North Carolina, the majority of the time the weather is clear. An interesting note is that snow still has a relatively high frequency despite it snowing minimally in North Carolina. 

```{r}
crashes %>% 
  filter(WeatherCondition1 != "NA") %>%
  count(WeatherCondition1) %>% 
  mutate(logtrans = round(log10(n), digits = 2),
         WeatherCondition1 = reorder(WeatherCondition1,logtrans)) %>% 
  ggplot(aes(x=WeatherCondition1, y=logtrans, fill=WeatherCondition1)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) +
  labs(title = "Frequency of Crashes by Weather Condition",
       x = "Weather Condition",
       y = "Count (log10 Scale)")
```

### Frequency of crashes by traffic control type.

The highest frequency of crashes occur when there is no traffic control present. Without a control present, drivers may be less confident in their actions. 

```{r}
crashes %>% 
  filter(TrafficControlType != "NA", TrafficControlType != "", 
         TrafficControlType != "NaN") %>%
  count(TrafficControlType) %>% 
  mutate(logtrans = round(log10(n), digits = 2),
         TrafficControlType = reorder(TrafficControlType,logtrans)) %>% 
  ggplot(aes(x=TrafficControlType, y=logtrans, fill=TrafficControlType)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) +
  labs(title = "Frequency of Crashes by Traffic Control Type",
       x = "Traffic Control Type",
       y = "Count (log10 Scale)")
```
 
### Frequency of crashes by road feature.

The highest frequency of crashes occur when there is no special road feature present. Without a road feature present, drivers may be less confident in their actions. 

```{r}
crashes %>% 
  filter(RoadFeature != "NA", RoadFeature != "", RoadFeature != "NaN") %>%
  count(RoadFeature) %>% 
  mutate(logtrans = round(log10(n), digits = 2),
         RoadFeature = reorder(RoadFeature,logtrans)) %>% 
  ggplot(aes(x=RoadFeature, y=logtrans, fill=RoadFeature)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) +
  labs(title = "Frequency of Crashes by Road Feature",
       x = "Road Feature",
       y = "Count (log10 Sclae)")
```

### Frequency of Crashes by Alcohol Result Type (including Unknown and Pending results)

```{r}
crashes %>% 
  filter(AlcoholResultType != "NA", AlcoholResultType != "", 
         AlcoholResultType != "NaN", AlcoholResultType != "Contaminated sample/unusable") %>%
  count(AlcoholResultType) %>% 
  mutate(logtrans = round(log10(n), digits = 2),
         AlcoholResultType = reorder(AlcoholResultType,logtrans)) %>% 
  ggplot(aes(x=AlcoholResultType, y=logtrans, fill=AlcoholResultType)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) +
  labs(title = "Frequency of Crashes by Alcohol Result Type",
       x = "Alcohol Result Type",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Alcohol Result Type (excluding Unknown and Pending results)

```{r}
crashes %>% 
  filter(AlcoholResultType != "NA", AlcoholResultType != "", 
         AlcoholResultType != "NaN", AlcoholResultType != 
           "Contaminated sample/unusable", AlcoholResultType != "Pending",
         AlcoholResultType != "Unknown") %>%
  count(AlcoholResultType) %>% 
  mutate(logtrans = round(log10(n), digits = 2),
         AlcoholResultType = reorder(AlcoholResultType,logtrans)) %>% 
  ggplot(aes(x=AlcoholResultType, y=logtrans, fill=AlcoholResultType)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) +
  labs(title = "Frequency of Crashes by Alcohol Result Type",
       x = "Alcohol Result Type",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Day of Week

```{r}
crashes %>% 
  filter(Crash_Date_DOW != "NA") %>%
  mutate(Crash_Date_DOW = factor(Crash_Date_DOW, levels = c("Sunday","Monday", "Tuesday", "Wednesday", 
                                   "Thursday", "Friday", "Saturday"))) %>%
  ggplot() +
  geom_bar(aes(Crash_Date_DOW, fill=Crash_Date_DOW), show.legend = FALSE) +
  geom_text(stat="count", aes(x=Crash_Date_DOW, label=..count..), vjust=-0.25) +
  labs(title = "Frequency of Crashes by Day of Week",
       x = "Day of Week",
       y = "Count")
```

### Frequency of Crashes by Month

```{r}
crashes %>% 
  filter(Crash_Date_Month != "NA") %>%
  mutate(Crash_Date_Month = factor(Crash_Date_Month, 
                                   levels = c("January","February",
                                              "March", "April",
                                              "May", "June", "July",
                                              "August", "September",
                                              "October", "November",
                                              "December"))) %>%
  ggplot() +
  geom_bar(aes(Crash_Date_Month, fill=Crash_Date_Month), show.legend = FALSE) +
  geom_text(stat="count", aes(x=Crash_Date_Month, label=..count..), vjust=-0.25) +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(title = "Frequency of Crashes by Month",
       x = "Month",
       y = "Count")
```

### Frequency of Crashes by Hour

```{r}
crashes %>%
  filter(Crash_Date_Hour != "NA", Crash_Date_Hour != "") %>%
  ggplot() +
  geom_bar(aes(Crash_Date_Hour)) +
  labs(title="Frequency of Crashes by Hour", x="Hour", y="Count")
```

### Frequency of Crashes by Shift

```{r}
crashes %>%
  filter(Crash_Date_Hour != "NA", Crash_Date_Hour != "") %>%
  mutate(shift = ifelse(
    Crash_Date_Hour >= 6 & Crash_Date_Hour < 14, "Shift 1", 
    ifelse(Crash_Date_Hour >= 14 & Crash_Date_Hour < 22, "Shift 2", "Shift 3"))) %>%
  ggplot() +
  geom_bar(aes(x=shift, fill = shift)) +
  labs(title="Frequency of Crashes by Shift", x="Shift", y="Count")
```


### Frequency of Crashes by Drivers' v. Passengers' Age

The range of drivers' ages is from about 16 to 100. The range of passengers' ages is from about 0 to 100. The range of drivers' ages is slightly larger due to the age restrictions for getting a license. 

```{r}
crashes %>% 
  filter(PersonType == "Driver" | PersonType == "Passenger", Age != "", Age != "NA") %>% 
  ggplot() +
  geom_histogram(aes(x=Age), binwidth = 5, col="red", fill="darkgrey") +
  labs(x="Age", y="Frequency", title="Drivers' vs. Passengers' Age") +
  theme(legend.position = "top") +
  facet_wrap(~PersonType)
```

### Frequency of Crashes by Vehicle Seizure

About half as many vehicles were seized compared to vehicles not seized. 

```{r} 
crashes %>% 
  filter(VehicleSeizure != "NA") %>%
  count(VehicleSeizure) %>% 
  mutate(logtrans = round(log10(n), digits = 2)) %>% 
  ggplot(aes(x=VehicleSeizure, y=logtrans, fill=VehicleSeizure)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  labs(title = "Frequency of Crashes by Vehicle Seizure",
       x = "Vehicle Seizure",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Airbag Deployed

The highest frequency of crashes occured where the airbags were not deployed. It is interesting to note that the second highest frequency of crashes occured where the car(s) did not have airbags to begin with. 

```{r}
crashes %>% 
  filter(AirbagDeployed != "NA", AirbagDeployed != "Unknown") %>%
  count(AirbagDeployed) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         AirbagDeployed = reorder(AirbagDeployed,logtrans)) %>% 
  ggplot(aes(x=AirbagDeployed, y=logtrans, fill=AirbagDeployed)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Airbag Deployed",
       x = "Airbag Deployed",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Ejection

Most car crashes resulted in drivers and passengers not being ejected. More people were totally ejected from the vehicle than partially ejected. 

```{r}
crashes %>% 
  filter(Ejection != "NA", Ejection != "Unknown") %>%
  count(Ejection) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         Ejection = reorder(Ejection,logtrans)) %>% 
  ggplot(aes(x=Ejection, y=logtrans, fill=Ejection)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Ejection",
       x = "Ejection",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Gender

There does not seem to be a significant difference between frequency of crashes between males and females. 

```{r}
crashes %>% 
  filter(Gender != "NA", Gender != "Unknown") %>%
  count(Gender) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         Gender = reorder(Gender,logtrans)) %>% 
  ggplot(aes(x=Gender, y=logtrans, fill=Gender)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Gender",
       x = "Gender",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Race

```{r}
crashes %>% 
  filter(Race != "NA", Race != "Unknown") %>%
  count(Race) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         Race = reorder(Race,logtrans)) %>% 
  ggplot(aes(x=Race, y=logtrans, fill=Race)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Race",
       x = "Race",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Injury

THe highest frequency of crashes did not result in any injury. Following the highest frequency, the more serious the injury, the less crashes occured. 

```{r}
crashes %>% 
  filter(Injury != "NA", Injury != "Unknown") %>%
  count(Injury) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         Injury = reorder(Injury,logtrans)) %>% 
  ggplot(aes(x=Injury, y=logtrans, fill=Injury)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Injury",
       x = "Injury",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Protection

The highest frequency of crashes occured when drivers and passengers wore a shoulder and lap belt protection which are common protections in more recent vehicles. However, the second highest frequency of crashes occured when drivers and passengers had used no protection. Could this be because the vehicles they were driving didn't provide protection or that the vehicles had protection, the people just chose not to use any. 

```{r}
crashes %>% 
  filter(Protection != "NA", Protection != "Unable to determine") %>%
  count(Protection) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         Protection = reorder(Protection,logtrans)) %>% 
  ggplot(aes(x=Protection, y=logtrans, fill=Protection)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Protection",
       x = "Protection",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Trapped

More crashes resulted in people in the vehicle not being trapped than people in the vehicle being trapped. 

```{r}
crashes %>% 
  filter(Trapped != "NA", Trapped != "Unknown") %>%
  count(Trapped) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         Trapped = reorder(Trapped,logtrans)) %>% 
  ggplot(aes(x=Trapped, y=logtrans, fill=Trapped)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Trapped",
       x = "Trapped",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Vision Obstruction

The highest frequency of crashes occured when there was was no vision obstruction. 

```{r}
crashes %>% 
  filter(VisionObstruction != "NA", VisionObstruction != "Unknown") %>%
  count(VisionObstruction) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         VisionObstruction = reorder(VisionObstruction,logtrans)) %>% 
  ggplot(aes(x=VisionObstruction, y=logtrans, fill=VisionObstruction)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Vision Obstruction",
       x = "Vision Obstruction",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Contributing Circumstance 1

The highest frequency of crashes had no contributing circumstances indicated. 

```{r}
crashes %>% 
  filter(ContributingCircumstance1 != "NA", ContributingCircumstance1 != "Unknown") %>%
  count(ContributingCircumstance1) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         ContributingCircumstance1 = reorder(ContributingCircumstance1,logtrans)) %>% 
  ggplot(aes(x=ContributingCircumstance1, y=logtrans, fill=ContributingCircumstance1)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Contributing Circumstance 1",
       x = "Contributing Circumstance 1",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Contributing Circumstance 2

The highest frequency of crashes had inattention as a contributing circumstance 2. 

```{r}
crashes %>% 
  filter(ContributingCircumstance2 != "NA", 
         ContributingCircumstance2 != "Unknown") %>%
  count(ContributingCircumstance2) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         ContributingCircumstance2 = reorder(ContributingCircumstance2,
                                             logtrans)) %>% 
  ggplot(aes(x=ContributingCircumstance2, y=logtrans, 
             fill=ContributingCircumstance2)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Contributing Circumstance 2",
       x = "Contributing Circumstance 2",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Contributing Circumstance 3

The higest frequency of crashes had inattention as a contributing circumstance 3. 

```{r}
crashes %>% 
  filter(ContributingCircumstance3 != "NA", 
         ContributingCircumstance3 != "Unknown") %>%
  count(ContributingCircumstance3) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         ContributingCircumstance3 = 
           reorder(ContributingCircumstance3,logtrans)) %>% 
  ggplot(aes(x=ContributingCircumstance3, y=logtrans, 
             fill=ContributingCircumstance3)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Frequency of Crashes by Contributing Circumstance 3",
       x = "Contributing Circumstance 3",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Location Relation to Road 

```{r}
crashes %>% 
  filter(LocationRelationToRoad != "NA", LocationRelationToRoad != "Unknown") %>%
  count(LocationRelationToRoad) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         LocationRelationToRoad = reorder(LocationRelationToRoad,logtrans)) %>% 
  ggplot(aes(x=LocationRelationToRoad, y=logtrans, fill=LocationRelationToRoad)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Location of Crash in Relation to Road",
       x = "Location Relation to Road",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Location In Near Indicator

```{r}
crashes %>% 
  filter(LocationInNearIndicator != "NA", LocationInNearIndicator != "Unknown") %>%
  count(LocationInNearIndicator) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         LocationInNearIndicator = reorder(LocationInNearIndicator,logtrans)) %>% 
  ggplot(aes(x=LocationInNearIndicator, y=logtrans, fill=LocationInNearIndicator)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Crashes Near Indicator",
       x = "Location in Near Indicator",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Location Ramp Indicator 

```{r}
crashes %>% 
  filter(LocationRampIndicator != "NA", LocationRampIndicator != "Unknown") %>%
  count(LocationRampIndicator) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         LocationRampIndicator = reorder(LocationRampIndicator,logtrans)) %>% 
  ggplot(aes(x=LocationRampIndicator, y=logtrans, fill=LocationRampIndicator)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Crash Location from Ramp",
       x = "Location Ramp Indicator",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Location Feet From Road 

```{r}
crashes %>% 
  filter(LocationFeetFromRoad != "NA", LocationFeetFromRoad != "Unknown") %>%
  count(LocationFeetFromRoad) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         LocationFeetFromRoad= reorder(LocationFeetFromRoad,logtrans)) %>% 
  ggplot(aes(x=LocationFeetFromRoad, y=logtrans, fill=LocationFeetFromRoad)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Crash Distance from Road",
       x = "Location Feet From Road",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Location Direction From Road

```{r}
crashes %>% 
  filter(LocationDirectionFromRoad != "NA", LocationDirectionFromRoad != "Unknown") %>%
  count(LocationDirectionFromRoad) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         LocationDirectionFromRoad= reorder(LocationDirectionFromRoad,logtrans)) %>% 
  ggplot(aes(x=LocationDirectionFromRoad, y=logtrans, fill=LocationDirectionFromRoad)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Direction of Crash",
       x = "Location Direction From Road",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Location From Indicator

```{r}
crashes %>% 
  filter(LocationAtFromIndicator != "NA", LocationAtFromIndicator != "Unknown") %>%
  count(LocationAtFromIndicator) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         LocationAtFromIndicator= reorder(LocationAtFromIndicator,logtrans)) %>% 
  ggplot(aes(x=LocationAtFromIndicator, y=logtrans, fill=LocationAtFromIndicator)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Indicator Crash Location",
       x = "Location At/From Indicator",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Location Direction to Road

```{r}
crashes %>% 
  filter(LocationDirectionToRoad != "NA", LocationDirectionToRoad != "Unknown") %>%
  count(LocationDirectionToRoad) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         LocationDirectionToRoad= reorder(LocationDirectionToRoad,logtrans)) %>% 
  ggplot(aes(x=LocationDirectionToRoad, y=logtrans, fill=LocationDirectionToRoad)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Direction of Crash From Road",
       x = "Location Direction To Road",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by First Harmful Event

```{r}
crashes %>% 
  filter(FirstHarmfulEvent != "NA", FirstHarmfulEvent != "Unknown") %>%
  count(FirstHarmfulEvent) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         FirstHarmfulEvent= reorder(FirstHarmfulEvent,logtrans)) %>% 
  ggplot(aes(x=FirstHarmfulEvent, y=logtrans, fill=FirstHarmfulEvent)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "First Harmful Crash Event ",
       x = "First Harmful Event",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Most Harmful Event

```{r}
crashes %>% 
  filter(MostHarmfulEvent != "NA", MostHarmfulEvent != "Unknown") %>%
  count(MostHarmfulEvent) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         MostHarmfulEvent= reorder(MostHarmfulEvent,logtrans)) %>% 
  ggplot(aes(x=MostHarmfulEvent, y=logtrans, fill=MostHarmfulEvent)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Most Harmful Crash Event ",
       x = "Most Harmful Event",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Road Classification

```{r}
crashes %>% 
  filter(RoadClassification != "NA", RoadClassification != "Unknown") %>%
  count(RoadClassification) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         RoadClassification= reorder(RoadClassification,logtrans)) %>% 
  ggplot(aes(x=RoadClassification, y=logtrans, fill=RoadClassification)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Classification of the Road ",
       x = "Road Classification",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Crash Date Year

```{r}
crashes %>% 
  filter(Crash_Date_Year != "Unknown", Crash_Date_Year != "2011") %>%
  count(Crash_Date_Year) %>% 
  mutate(logtrans = round(log10(n), digits = 4)) %>% 
  ggplot(aes(x=Crash_Date_Year, y=logtrans, fill=Crash_Date_Year)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  geom_text(aes(label=logtrans),nudge_y=0.5) + 
  geom_abline(intercept = log10(387995/6.5), slope = 0, lty="dashed", color="darkgrey") +
  labs(title = "Frequency of Crashes by Year", 
       x = "Year", 
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Drivers

```{r}
crashes %>% 
  filter(drivers != "NA", drivers != "") %>%
  count(drivers) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         drivers= reorder(drivers,logtrans)) %>% 
  ggplot(aes(x=drivers, y=logtrans, fill=drivers)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Drivers per Crash",
       x = "Number of Drivers",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Passengers

```{r}
crashes %>% 
  filter(passengers != "NA", passengers != "") %>%
  count(passengers) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         passengers= reorder(passengers,logtrans)) %>% 
  ggplot(aes(x=passengers, y=logtrans, fill=passengers)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Passengers per Crash",
       x = "Number of Passengers",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Pedestrians

```{r}
crashes %>% 
  filter(pedestrians != "NA", pedestrians != "") %>%
  count(pedestrians) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         pedestrians= reorder(pedestrians,logtrans)) %>% 
  ggplot(aes(x=pedestrians, y=logtrans, fill=pedestrians)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Pedestrians per Crash",
       x = "Number of Pedestrians",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Pedalcyclists

```{r}
crashes %>% 
  filter(pedalcyclists != "NA", pedalcyclists != "") %>%
  count(pedalcyclists) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         pedalcyclists= reorder(pedalcyclists,logtrans)) %>% 
  ggplot(aes(x=pedalcyclists, y=logtrans, fill=pedalcyclists)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Pedalcyclists per Crash",
       x = "Number of Pedalcyclists",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Other Person Type

```{r}
crashes %>% 
  filter(other_person_type != "NA", other_person_type != "") %>%
  count(other_person_type) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         other_person_type= reorder(other_person_type,logtrans)) %>% 
  ggplot(aes(x=other_person_type, y=logtrans, fill=other_person_type)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Others per Crash",
       x = "Number of Others",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Unknown Person Type

```{r}
crashes %>% 
  filter(unknown_person_type != "NA", unknown_person_type != "") %>%
  count(unknown_person_type) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         unknown_person_type= reorder(unknown_person_type,logtrans)) %>% 
  ggplot(aes(x=unknown_person_type, y=logtrans, fill=unknown_person_type)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Unknown per Crash",
       x = "Number of Unknown",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Number of People Killed

```{r}
crashes %>% 
  filter(killed != "NA", killed != "") %>%
  count(killed) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         killed= reorder(killed,logtrans)) %>% 
  ggplot(aes(x=killed, y=logtrans, fill=killed)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number Killed per Crash",
       x = "Number Killed",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Type A Injury 

```{r}
crashes %>% 
  filter(type_a_injury != "NA", type_a_injury != "") %>%
  count(type_a_injury) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         type_a_injury= reorder(type_a_injury,logtrans)) %>% 
  ggplot(aes(x=type_a_injury, y=logtrans, fill=type_a_injury)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Type A Injuries per Crash",
       x = "Number of Type A Injuries",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Type B Injury 

```{r}
crashes %>% 
  filter(type_b_injury != "NA", type_b_injury != "") %>%
  count(type_b_injury) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         type_b_injury= reorder(type_b_injury,logtrans)) %>% 
  ggplot(aes(x=type_b_injury, y=logtrans, fill=type_b_injury)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Type B Injuries per Crash",
       x = "Number of Type B Injuries",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Type C Injury 

```{r}
crashes %>% 
  filter(type_c_injury != "NA", type_c_injury != "") %>%
  count(type_c_injury) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         type_c_injury= reorder(type_c_injury,logtrans)) %>% 
  ggplot(aes(x=type_c_injury, y=logtrans, fill=type_c_injury)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Type C Injuries per Crash",
       x = "Number of Type C Injuries",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by No Injury 

```{r}
crashes %>% 
  filter(no_injury != "NA", no_injury != "") %>%
  count(no_injury) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         no_injury= reorder(no_injury,logtrans)) %>% 
  ggplot(aes(x=no_injury, y=logtrans, fill=no_injury)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Non-Injured per Crash",
       x = "Number of Non-Injured",
       y = "Count (log10 Scale)")
```

### Frequency of Crashes by Injury Unknown 

```{r}
crashes %>% 
  filter(injury_unknown != "NA", injury_unknown != "") %>%
  count(injury_unknown) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         injury_unknown= reorder(injury_unknown,logtrans)) %>% 
  ggplot(aes(x=injury_unknown, y=logtrans, fill=injury_unknown)) +
  geom_bar(stat = "identity", show.legend = FALSE) + 
  geom_text(aes(label=logtrans),nudge_y=0.2) +
  coord_flip() +
  labs(title = "Number of Unknown Injuries per Crash",
       x = "Number of Unknown Injuries",
       y = "Count (log10 Scale)")
```

<<<<<<< HEAD
=======
### Histogram for Drivers' Ages

```{r}
crashes %>%
  filter(PersonType == "Driver", Age != "NA", Age != "NaN", Age != "") %>%
  ggplot() +
  geom_histogram(aes(x=Age), binwidth = 5, col="red", fill="darkgrey") +
  labs(title="Histogram for Drivers' Ages", x="Age", y="Frequency")
```


>>>>>>> 7e5f37f3c632b16ac5201996e4f2a19f0599c47e
## Visualizing text data using word clouds 

### Installing and loading necessary packages 

```{r}
<<<<<<< HEAD
install.packages('wordcloud2')
=======
#install.packages('wordcloud2')
>>>>>>> 7e5f37f3c632b16ac5201996e4f2a19f0599c47e
library(wordcloud2)
```

### Word Cloud for Location Road Name On  

```{r}
location_road_name_on_freq <- crashes %>%
  count(LocationRoadNameOn)
<<<<<<< HEAD

=======
>>>>>>> 7e5f37f3c632b16ac5201996e4f2a19f0599c47e
set.seed(101)
location_road_name_on_freq %>%
  wordcloud2(shape = 'circle', backgroundColor = "black", minSize = 5)
```
<<<<<<< HEAD

### Word cloud for location road name at

```{r}
location_road_name_at_freq <- crashes %>%
  count(LocationRoadNameAt)

set.seed(102)
location_road_name_at_freq %>%
  wordcloud2(shape = 'circle', backgroundColor = "black", minSize = 5)
```

=======
>>>>>>> 7e5f37f3c632b16ac5201996e4f2a19f0599c47e
