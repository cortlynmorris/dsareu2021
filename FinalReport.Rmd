---
title: 
  \vspace{3in} "Visualizing, Modeling, and Forecasting Crashes in Wake County, North Carolina"
author: 
  - Cortlyn Morris, Kelly Wenzlof, Ayan Gulzar
  - Research Mentors Dr. Sayed Mostafa and Chinedu Jude Nzekwe 
date: "7/14/2021"
header-includes:
    - \usepackage{setspace}\doublespacing
output: 
  pdf_document
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

\newpage
\tableofcontents
\newpage


# Abstract

Studies have shown that road traffic crashes are one of the leading causes of non-natural death for U.S citizens. There are many different ways that road crashes occur, and several various factors lead to it. It is essential to analyze the most common elements of road crashes. In this report, our goal is to model and forecast crashes in Wake County, North Carolina. To accomplish this goal, a public dataset  called  North Carolina Wake County crashes was available to use. The crash dataset used in this research was from 2015 to March 2021. Using the dataset to our advantage our intent is to  observe which factors have a higher cause of crashes in Wake County. The objective of this research is to address the above research question by using bar plots of common factors leading to crashes and Time Series Forecasting crashes in Wake County.

\newpage

# Introduction 

Car crashes are something that occurs nearly every day. On average, there are 16,438 car crashes per day in the U.S. When it comes to car accidents, several factors correlate. However, it is crucial to understand some of the most frequent causes of crashes. Analyzing the most common reasons can help notify other drivers on the road so that there can be a decrease in crashes. 

When it comes to identifying car crashes, different states in the U.S experience crashes at different rates. Road accidents do not only harm the driver of the vehicle. It also affects the passenger and the pedestrians.  Most people assume that the driver gets injured the most in a road accident. Passengers and pedestrians are still dying at high rates.

From the beginning of 2015, information on car crashes has been listed in the Wake County car accident database. This data includes the driver's age, gender, vehicle type, and many more critical car accident factors. Our database is based on what police officers have recorded at the scene of the accident. Most of the data found in this database are true, but there is a small percentage of error with some of the data. Our goal is to sort out essential factors from the database to help forecast crashes in Wake County.

In this report, we will be visualizing, modeling and forecasting car crashes in Wake County. Our research questions are 1) What are the main factors that contribute to a crash? 2) Did the law change to obtaining a driverâ€™s license due to the COVID pandemic impact crash frequency? 3) What are the conditions that lead to worse outcomes in terms of crash injuries?4) Can we forecast the daily number of crashes in Wake County? 5) Can we predict traffic hotspots in Wake County? We assembled a dataset from the Wake County crashes database from 2015 to March 2021. Although some of the input in the database is missing, this data will help provide some information about crashes in Wake County. This will also help us forecast car crashes after 2021. 

# Background 

When it comes to car crashes, people assume that the driver was either speeding or not paying attention. It is essential to understand that there are other factors to consider when a car accident occurs. Since everything has slowly started to open after the COVID-19 pandemic, there has been an increase in car crashes. Studying the different factors of impacts can help decrease the number of accidents.

## Hotspots

When looking at car crashes it is essential to study hotspots and notice roads where crashes are common. Some roads might not be known for accidents and others might be known for having the most accidents or even most life-threatening crashes. There has not been a lot of research done on the types of roads that crashes occur on. This is something to consider when looking at road crashes because it gives us a better understanding of roads where crashes are more common than others.  

## Weather Condition

Weather conditions are a prominent factor in car crashes. When studying car crashes it is crucial to study how the weather affects a crash. Sometimes crashes tend to increase when there is bad weather. Researchers have found that rain was one of the top contributors to weather-related auto crashes.

## Outro 

With all these factors of crashes done in previous research, some have not studied in-depth about this topic. Our goal is to expand this topic as we found there is no research on the main factors that cause car accidents. The condition that leads to the worst outcome to injuries. Lastly, the most common road that crashes happen. We will forecast  Crashes in Wake County, North Carolina from 2015 to March 2021. 

# Data, Method, and Analysis 

## Data

For this study, we utilized public data from the Wake County crashes dataset. We combined datasets from each year so that we could forecast car crashes in Wake County. This database gets updated every month and has all the specifications for the car accident. 

```{r loading-libraries, message=FALSE, warning=FALSE, echo=FALSE, include=FALSE}
library(reshape2)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(dslabs)
library(ggrepel)
library(ggthemes)
library(maps)
library(scales)
library(zoo)
```

```{r read-data, message=FALSE, echo=FALSE, include=FALSE}
#Code for Cortlyns computer (Mac)
 # setwd("/Users/cmorris/Desktop/dsreu2021/rstudiodirectory/ResearchProject")
 # persons <- read.csv(file="Persons_Involved_in_Crashes.csv")
 # glimpse(persons)
 #    
 # locations <- read.csv(file="Reported_Crash_Locations.csv")
 # glimpse(locations)
 #    
 # crashes <- persons %>% left_join(locations, by="key_crash")

#Code for Kelly's computer (Windows)
#library(readr)
persons <- read_csv("~/NCAT REU/Mostafa/Data/Persons_Involved_in_Crashes.csv")

locations <- read_csv("~/NCAT REU/Mostafa/Data/Reported_Crash_Locations.csv")

crashes <- persons %>% left_join(locations, by="key_crash")

# Code for Ayan's computer (Window)
#library(readr)
# persons <- read_csv("C:/Users/ayang/Desktop/Project FIles REU A&T/REU Research Project1/Persons_Involved_in_Crashes.csv")
# 
# locations <- read_csv("C:/Users/ayang/Desktop/Project FIles REU A&T/REU Research Project1/Reported_Crash_Locations.csv")
# 
# crashes <- persons %>% left_join(locations, by="key_crash")
```

## Method 

### Exploratory Data Analysis 

Exploratory data analysis was the first step in the process of understanding and finding patterns within the crash data set. We conducted univariate and bivariate explorations. 

#### Univariate Explorations 

Below are the most important univariate visualizations that we discovered. 

```{r driver-passenger-age, echo=FALSE}
crashes %>% 
  filter(PersonType == "Driver" | PersonType == "Passenger", Age != "", Age != "NA") %>% 
  ggplot() +
  geom_histogram(aes(x=Age), binwidth = 5, col="red", fill="darkgrey") +
  labs(x="Age", y="Frequency", title="Drivers' vs. Passengers' Age") +
  theme(legend.position = "top") +
  facet_wrap(~PersonType, dir = "v")
```

For the graph above we created a histogram to compare the drivers' and passengers' age. This helped us understand what age is common for drivers to get injured in a car accident. The range of drivers' ages is from about 16 to 100. The range of passengers' ages is from about 0 to 100. The range of drivers' ages is slightly larger due to the age restrictions for getting a license.

```{r crash-year, echo=FALSE}
crashes %>% 
  filter(Crash_Date_Year != "Unknown", Crash_Date_Year != "2011") %>%
  ggplot(aes(Crash_Date_Year, fill=as.factor(Crash_Date_Year))) +
  geom_bar(show.legend = FALSE) +
  geom_text(stat="count", aes(x=Crash_Date_Year, label=..count..), vjust=-0.25) + 
  geom_abline(intercept = 387995/(77/12), slope = 0, lty="dashed") +
  scale_x_continuous(breaks=2015:2021) +
  labs(title = "Frequency of Crashes by Year", 
       x = "Year", 
       y = "Count")
```

For this bar plot, we had data for the years 2015 to March 2021. In the visual above you can see that there was a high rate of car accidents from the beginning of 2015 to the end of 2019.We included a horizontal dashed line to indicate where the yearly average lies and we can see that only the years 2020 and 2021 fall below this yearly average. The year with the most crashes in 2019 but not by many. The full year with the fewest crashes in 2020 which was to be expected due to the lockdowns that took place to try and mitigate the spread of Covid-19. 2021 also looks to be on track to be another low crash year but we do not have a perfect explanation for that seeing as things are beginning to open and "return to normal" again.

```{r weather-condition, echo=FALSE}
crashes %>% 
  filter(WeatherCondition1 != "NA") %>%
  count(WeatherCondition1) %>% 
  mutate(logtrans = round(log10(n), digits = 2),
         WeatherCondition1 = reorder(WeatherCondition1,logtrans)) %>% 
  ggplot(aes(x=WeatherCondition1, y=logtrans, fill=WeatherCondition1)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) +
  labs(title = "Frequency of Crashes by Weather Condition",
       x = "Weather Condition",
       y = "Count (log10 Scale)")
```

For this visual, we also created a bar plot to determine which weather condition tends to be the most common for car crashes. After constructing the bar plot you can recognize that most crashes tend to happen when the weather is clear. This is not very surprising because in North Carolina, the majority of the time the weather is clear. An interesting note is that snow still has a relatively high frequency despite it snowing minimally in North Carolina. 

```{r vehicle-type, echo=FALSE}
crashes %>% 
  filter(VehicleType != "Unknown", VehicleType != "") %>%
  count(VehicleType) %>% 
  mutate(logtrans = round(log10(n), digits = 2), 
         VehicleType = reorder(VehicleType,logtrans)) %>% 
  ggplot(aes(x=VehicleType, y=logtrans, fill=VehicleType)) +
  geom_bar(stat = "identity", show.legend = FALSE) +
  coord_flip() + 
  geom_text(aes(label=logtrans),nudge_y=0.5) + 
  labs(title = "Frequency of Crashes by Vehicle Type", 
       x = "Vehicle Type", 
       y = "Count (log10 Scale)")
```

For the type of vehicle in a crash we had data for the years 2015 to March 2021. This bar plot helps us understand the most common vehicles and the least common vehicles in an accident in Wake County. The highest frequency of crashes occur in a passenger car. However, this is not very surprising because passenger cars are relatively common. An interesting note is that sport utility vehicles have the second highest frequency of crashes, however, sport utility vehicles are not nearly as common of a car.

#### Bivariate Explorations

This section is dedicated to visualizing factors that may lead to worse outcomes of crashes in terms of injury. Using percent stacked bar charts, we are able to determine which variables lead to a more or less serious injuries which we can later use to help predict the seriousness of injury through predictive modeling. 

Below are some of the most important bivariate explorations. 

```{r contrib-circum-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", ContributingCircumstance1 != "NA", 
         ContributingCircumstance1 != "NaN", 
         ContributingCircumstance1 != "Unable to determine", 
         ContributingCircumstance1 != "Unknown", 
         ContributingCircumstance1 !="") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=ContributingCircumstance1)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Contributing Circumstance",
       x = "Contributing Circumstance",
       y = "Percentage") + 
  scale_x_discrete(labels = c("Alcohol use", 
                              "Going wrong way",
                              "Disregarded other traffic signs",
                              "Disregarded road markings",
                              "Disregarded stop sign",
                              "Disregarded traffic signals",
                              "Disregarded yield sign", 
                              "Driver distracted",
                              "Driver distracted by communication device",
                              "Driver distracted by external distraction", 
                              "Driver distracted by electronic",
                              "Driver distracted by passenger", 
                              "Drug use", 
                              "Exceeded speed limit",
                              "Exceeded safe speed", 
                              "Failed to yield", 
                              "Failure to reduce speed",
                              "Followed too closely",
                              "Improper backing",
                              "Improper lane change", 
                              "Improper or no signal",
                              "Improper parking",
                              "Improper turn",
                              "Inattention",
                              "No contributing circumstance",
                              "Operated defective equipment", 
                              "Erratic, reckless, negligent", 
                              "Other improper passing", 
                              "Other*",
                              "Overcorrected/oversteered",
                              "Passed on curve",  
                              "Passed on hill",
                              "Passed stopped school bus", 
                              "Right turn on red",
                              "Swerved or avoided",  
                              "Use of improper lane",
                              "Visibility obstructed"))
```

From the percent stacked bar chart above, it is important to note that exceeding the speed limi leads to very serious injuries, has the lowest rate of no injury, and has the highest rate of people being killed. 

```{r driver-age-injury, echo=FALSE}
# Comparing Injury to Driver Age
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", Injury != "", PersonType == "Driver", Age != "NA",
         Age != "", Age != "Unknown", Age >= 5) %>%
  group_by(Injury) %>%
  mutate(shift = case_when(
    Age >= 5 & Age < 15 ~ "5-14",
    Age >= 15 & Age < 25 ~ "15-24",
    Age >= 25 & Age < 35 ~ "25-34",
    Age >= 35 & Age < 45 ~ "35-44",
    Age >= 45 & Age < 55 ~ "45-54",
    Age >= 55 & Age < 65 ~ "55-64",
    Age >= 65 & Age < 75 ~ "65-74",
    Age >= 75 & Age < 85 ~ "75-84",
    Age >= 85 & Age < 95 ~ "85-94",
    Age >= 95 & Age < 105 ~ "95-104",
    Age >= 105 & Age < 115 ~ "105-114",
    TRUE ~ "115-124")) %>%
  ggplot(aes(fill=Injury, x=shift)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Driver Age",
       x = "Age",
       y = "Percentage")
```

```{r driver-age, echo=FALSE}
crashes %>%
  filter(PersonType == "Driver", Age != "NA",
         Age != "", Age != "Unknown", Age >= 5) %>%
  mutate(age = case_when(
    Age >= 5 & Age < 15 ~ "5-14",
    Age >= 15 & Age < 25 ~ "15-24",
    Age >= 25 & Age < 35 ~ "25-34",
    Age >= 35 & Age < 45 ~ "35-44",
    Age >= 45 & Age < 55 ~ "45-54",
    Age >= 55 & Age < 65 ~ "55-64",
    Age >= 65 & Age < 75 ~ "65-74",
    Age >= 75 & Age < 85 ~ "75-84",
    Age >= 85 & Age < 95 ~ "85-94",
    Age >= 95 & Age < 105 ~ "95-104",
    Age >= 105 & Age < 115 ~ "105-114",
    TRUE ~ "115-124")) %>%
  mutate(age = factor(age, levels = c("5-14", "15-24", "25-34", "35-44", "45-54",
                                      "55-64", "65-74", "75-84", "85-94", 
                                      "95-104", "105-114", "115-124"))) %>%
  ggplot(aes(fill=age, x=age)) + 
  geom_bar(show.legend = FALSE) + 
  labs(title = "Frequency of Driver Age",
       x = "Age",
       y = "Count") + 
  theme(axis.text.x = element_text(angle = 90))
```

From the percent stacked bar chart and the bar chart above... 

```{r passenger-age-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", Injury != "", PersonType == "Passenger", Age != "NA",
         Age != "", Age != "Unknown") %>%
  group_by(Injury) %>%
  mutate(shift = case_when(
    Age >= 0 & Age < 10 ~ "0-9",
    Age >= 10 & Age < 20 ~ "10-19",
    Age >= 20 & Age < 30 ~ "20-29",
    Age >= 30 & Age < 40 ~ "30-39",
    Age >= 40 & Age < 50 ~ "40-49",
    Age >= 50 & Age < 60 ~ "50-59",
    Age >= 60 & Age < 70 ~ "60-69",
    Age >= 70 & Age < 80 ~ "70-79",
    Age >= 80 & Age < 90 ~ "80-89",
    Age >= 90 & Age < 100 ~ "90-99",
    Age >= 100 & Age < 110 ~ "100-109",
    Age >= 110 & Age < 120 ~ "110-119",
    TRUE ~ "120-129")) %>%
  ggplot(aes(fill=Injury, x=shift)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Passenger Age",
       x = "Age",
       y = "Percentage")
```

```{r passenger-age, echo=FALSE}
crashes %>%
  filter(PersonType == "Passenger", Age != "NA",
         Age != "", Age != "Unknown") %>%
  mutate(age = case_when(
    Age >= 0 & Age < 10 ~ "0-9",
    Age >= 10 & Age < 20 ~ "10-19",
    Age >= 20 & Age < 30 ~ "20-29",
    Age >= 30 & Age < 40 ~ "30-39",
    Age >= 40 & Age < 50 ~ "40-49",
    Age >= 50 & Age < 60 ~ "50-59",
    Age >= 60 & Age < 70 ~ "60-69",
    Age >= 70 & Age < 80 ~ "70-79",
    Age >= 80 & Age < 90 ~ "80-89",
    Age >= 90 & Age < 100 ~ "90-99",
    Age >= 100 & Age < 110 ~ "100-109",
    Age >= 110 & Age < 120 ~ "110-119",
    TRUE ~ "120-129")) %>%
  mutate(age = factor(age, levels = c("0-9", "10-19", "20-29", "30-39", "40-49", 
                                      "50-59", "60-69", "70-79", "80-89", 
                                      "90-99", "100-109", "110-119",
                                      "120-129"))) %>%
  ggplot(aes(fill=age, x=age)) + 
  geom_bar(show.legend = FALSE) + 
  labs(title = "Frequency of Passenger Age",
       x = "Age",
       y = "Percentage") + 
  theme(axis.text.x = element_text(angle = 90))
```

From the percent stacked bar chart and the bar chart above... 

```{r vehicle-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", VehicleType != "NA", 
         VehicleType != "NaN", VehicleType != "Unknown", VehicleType != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=VehicleType)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Vehicle Type",
       x = "Vehicle Type",
       y = "Percentage")
```

Pedestrian were the most killed, followed by motorcycles and motor scooters. This makes sense because these people are more exposed to conditions as well as generally having less protection than people in enclosed vehicles. Large vehicles like buses, trucks, and military vehicles, had the leaast amount of injuries most likely due to their large size.

```{r protection-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", Protection != "NA", 
         Protection != "NaN", Protection != "Unable to determine", 
         Protection != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=Protection)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Protection",
       x = "Protection",
       y = "Percentage")
```

The most injuries occurred when people were using reflective clothing, lighting, and a helmet as protection. This makes sense because people using this would most likely be pedestrians or bikers, both of which are more exposed to danger and to having more significant injuries. Shoulder belts, lap belts, and the combination between the two appear to help decrease the amount of injuries that occur.

```{r weather-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", WeatherCondition1 != "NA", 
         WeatherCondition1 != "NaN", WeatherCondition1 != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=WeatherCondition1)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Weather Condition",
       x = "Weather Condition",
       y = "Percentage")
```

Rain and sleet, hail, freezing rain/drizzle leads to the most disabling type injuries. 

```{r most-harm-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", MostHarmfulEvent != "NA", 
         MostHarmfulEvent != "NaN", MostHarmfulEvent != "Unknown") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=MostHarmfulEvent)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Most Harmful Event",
       x = "Most Harmful Event",
       y = "Percentage")
```

The most harmful event that led to most people killed and disabling injuries was with pedestrians. This would make sense because pedestrians often do not have protection from cars. Overturn/rollover harmful events also had a significant amount of injuries. Backing up had the least amount of injuries which would make sense because when backing a car up, people tend to be going a slower speed than if they were accelerating forward. 

```{r road-feat-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", RoadFeature != "NA", 
         RoadFeature != "NaN", RoadFeature != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=RoadFeature)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Road Feature",
       x = "Road Feature",
       y = "Percentage")
```

Driveways tend to lead to the least amount of injuries probably due to the slow speed that people are going when in driveways. 

```{r traffic-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", TrafficControlType != "NA", 
         TrafficControlType != "NaN", TrafficControlType != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=TrafficControlType)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() +
  labs(title = "Injury Frequency by Traffic Control Type",
       x = "Traffic Control Type",
       y = "Percentage")
```

Places where warning signs are post led to the post injuries including people killed. This may be because the signs are not taken as seriously and are less common to see, therefore, more people may disregard the warnings. Not many injuries occur near Railroad crossings. 

```{r road-class-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", RoadClassification != "NA", 
         RoadClassification != "NaN", RoadClassification != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=RoadClassification)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Road Classification",
       x = "Road Classification",
       y = "Percentage")
```

Public vehicular areas and private roads/driveways lead to the least amount of injuries. This may be because these areas are minimally trafficked and are usually at slower speeds than other roads. 

```{r person-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", Injury != "", PersonType != "NA", 
        PersonType != "NaN", PersonType != "Unknown", PersonType != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=PersonType)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Person Type",
       x = "Person Type",
       y = "Percentage")
```

Pedestrians are most likely to die, followed by pedalcyclists most likely due to lack of protection and high exposure to the environment. Driver's are slightly less likely to be injured than passengers. 

```{r alcohol-filter-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", AlcoholResultType != "NA", 
         AlcoholResultType != "NaN", AlcoholResultType != "Unknown",
         AlcoholResultType != "Contaminated sample/unusable", 
         AlcoholResultType != "Pending", AlcoholResultType != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=AlcoholResultType)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Alcohol Result Type",
       x = "Alcohol Result Type",
       y = "Percentage")
```

The most people are killed when there are no alcohol or other drugs. This is slightly surprising, however, it may be because when people are driving with drugs or alcohol in their system, they may attempt to be more cautious so that they do not get pulled over by police. 

```{r vision-obstruct-injury, echo=FALSE}
crashes %>%
  filter(Injury != "NA", Injury != "Unknown", VisionObstruction != "NA", 
         VisionObstruction != "NaN", VisionObstruction != "") %>%
  group_by(Injury) %>%
  ggplot(aes(fill=Injury, x=VisionObstruction)) + 
  geom_bar(position="fill", stat="count") + 
  coord_flip() + 
  labs(title = "Injury Frequency by Vision Obstruction",
       x = "Vision Obstruction",
       y = "Percentage")
```

Signs and embankment led to the most people being killed. This may be because these are both stationary opaque objects that will continuously block people's views of the road and conditions. Also being blinded by other lights led to the most disabling injuries. 

### Identifying Hot Spots of Crashes

This section is dedicated to identifying hot spots of crashes in Wake County, North Carolina. 

#### Word Clouds 

Below are two word clouds created to visualize the frequency of crashes on streets in Wake County, North Carolina. 

```{r tool, message=FALSE, echo=FALSE}
devtools::install_github("gaospecial/wordcloud2")
```

```{r load-library-word-cloud, message=FALSE, echo=FALSE}
#install.packages('wordcloud2')
library(wordcloud2)
```

```{r location-on-word-cloud, echo=FALSE}
location_road_name_on_freq <- crashes %>%
  count(LocationRoadNameOn)

set.seed(101)
location_road_name_on_freq %>%
  wordcloud2(shape = 'circle', backgroundColor = "black", minSize = 5) 
```

From the word cloud, we can see many crashes occur on 440, 40, and Capital Blvd. This makes sense because 440 and 40 are major interstates that connect to several major junctions and Capital Blvd is a main road in North Carolina as well. 

```{r location-at-word-cloud, echo=FALSE}
location_road_name_at_freq <- crashes %>%
  count(LocationRoadNameAt)

set.seed(102)
location_road_name_at_freq %>%
  wordcloud2(shape = 'circle', backgroundColor = "black", minSize = 5)
```

From the word cloud, we can see that 440, Capital Blvd, 40, and Blue Ridge Rd frequently have crashes that are near by. This would make sense because most of these streets are highly trafficked and populated.

#### Interactive Heat Maps 

Below are two interactive heat maps dedicated to organizing the data in a spatial manner. 

```{r load-library-interactive-map, message=FALSE, echo=FALSE}
library(ggplot2)
#install.packages("ggmap")
library(ggmap)
library(RColorBrewer)
library(plotly)
```

```{r nc-interactive-map, message=FALSE, warning=FALSE, echo=FALSE}
map_bounds <- c(-78.98, 35.51, -78.24, 36.06)

crashes_filter <- crashes %>%
  filter(LocationLatitude != "0", LocationLongitude != "0",
         LocationLatitude != "NA", LocationLatitude != "",
         LocationLongitude != "NA", LocationLongitude != "",
         LocationLatitude > 35.4, LocationLatitude < 36.2,
         LocationLongitude < -78, LocationLongitude > -79)

coords.map.nc <- get_stamenmap(map_bounds, zoom = 10, maptype = "toner-lite")

coords.map.nc <- ggmap(coords.map.nc, extent="panel", legend="none")
coords.map.nc <- coords.map.nc + stat_density2d(data=crashes_filter,  
                                          aes(x=LocationLongitude, 
                                              y=LocationLatitude, 
                                              fill=..level..),
                                          alpha = 0.3, 
                                          geom="polygon")
coords.map.nc <- coords.map.nc +   scale_fill_gradientn(colours=rev(brewer.pal(7, "RdBu")))

coords.map.nc <- coords.map.nc + theme_bw() + 
  ggtitle("Interactive Heat Map of Crashes in North Carolina (Zoomed-Out)") + 
  xlab("Longitude") + ylab("Latitude")

ggplotly(coords.map.nc) %>%
  highlight(
    "plotly_hover",
    selected = attrs_selected(line = list(color = "black"))
  )
```

In the visual above we created a heat map of common places where road accidents occur in North Carolina. 

```{r wake-interactive-map, message=FALSE, warning=FALSE, echo=FALSE}
crashes_filter <- crashes %>%
  filter(LocationLatitude != "0", LocationLongitude != "0",
         LocationLatitude != "NA", LocationLatitude != "",
         LocationLongitude != "NA", LocationLongitude != "",
         LocationLatitude > 35.4, LocationLatitude < 36.2,
         LocationLongitude < -78, LocationLongitude > -79)

map_bounds <- c(-78.8, 35.72, -78.5, 35.9) #coordinates of wake county

coords.map.wake <- get_stamenmap(map_bounds, zoom = 13, maptype = "toner-lite")

coords.map.wake <- ggmap(coords.map.wake, extent="panel")
coords.map.wake <- coords.map.wake + stat_density2d(data=crashes_filter,  
                                          aes(x=LocationLongitude, 
                                              y=LocationLatitude, 
                                              fill=..level..),
                                          alpha=0.3, 
                                          geom="polygon")

coords.map.wake <- coords.map.wake + scale_fill_gradientn(colours=rev(brewer.pal(7, "RdYlGn")))

coords.map.wake <- coords.map.wake + theme_bw() + 
  ggtitle("Heat Map of Crash Locations") + 
  xlab("Latitude") + ylab("Longitude")

ggplotly(coords.map.wake) %>%
  highlight(
    "plotly_hover",
    selected = attrs_selected(line = list(color = "black"))
  )
```

Above we created an interactive heat map for Wake County. This heat map shows popular streets where it is common to have an accident. From the Wake County heat map, we can see that crashes are much more likely to occur in the center of the city. We see that as more streets populate an area, more crashes occur. 

### Time Series Visualization 

This section is dedicated to visualizing the entire data set of car crashes in Wake County, North Carolina from January 1, 2015 to May 31, 2021. 

```{r load-library-ts, echo=FALSE, message=FALSE}
library(zoo)
```

```{r crashes-ts, echo=FALSE}
crashes_ts = crashes %>%
  separate(crash_date, 
           into = c("Date", "Hour"), sep = 11) %>%
  group_by(Date) %>%
  summarize(count = length(unique(key_crash)))
```

```{r 7-day-ma-ts, echo=FALSE, warning=FALSE}
crashes_ts %>%
  filter(as.Date(Date) >= "2015/01/01") %>%
  ggplot(aes(x = as.Date(Date), y = count)) + 
  geom_line() +
  geom_line(aes(y=rollmean(count, 7, na.pad = TRUE)), color = "red") +
  scale_x_date(date_labels = "%m-%Y", date_breaks = "6 month") + 
  theme(axis.text.x = element_text(angle = 90), title = element_text(size=8)) + 
  ggtitle("Time Series Plot for Frequency of Daily Crashes With 7 Day Moving Average (With Pandemic Data)")
```

Above we have a time series plot of a seven day moving average of the number of crashes. We see that there are major spikes around March 2015, late October 2015, and December 2016. The two latter spikes may be related to the popular holidays, Halloween and Christmas. 

Additionally, from the time series plot, we can see that there is a significant drop in car crashes in March 2020. This can be explained by the stay-at-home-orders due to the COVID-19 pandemic. After the stay at home orders, the frequency of crashes seems to be slightly lower throughout May 2021. There will likely be an increase in the next few month due to stay-at-home-orders and COVID-19 regulations being lifted now that the vaccination is available. 

```{r annual-ts, echo=FALSE}
crashes_annual = crashes_ts %>%
  separate(Date, 
           into = c("Year", "Month"), sep = 4, remove = FALSE) %>%
  select(-Month)

crashes_annual %>%
  filter(as.Date(Date) >= "2015/01/01") %>%
  ggplot(aes(x = as.Date(Date), y = count)) + 
  ggtitle("Time Series Plots for Frequency of Daily Crashes Organized by Year") + 
  geom_line() + 
  scale_x_date(date_labels = "%m-%Y", date_breaks = "1 month") + 
  xlab("Date") + ylab("Count") + 
  theme(axis.text.x = element_text(angle = 90)) +
  facet_wrap(~Year, scales = "free_x")
```

Above, we can see the daily time series plot broken into annual plots. This helps better visualize the spikes and dips throughout the specific years. 

### Time Series Forecasting 

#### Stationary Transformation 

### Statistical Analyses 

### Predictive Models 

# Results 

## Time Series Analysis Results 

### Time Series Forecasting 

### Forecasting with Covariates 

#### Daily with Pandemic Data 

#### Daily without Pandemic Data 

#### Monthly with Pandemic Data

#### Monthly without Pandemic Data 

## Predictive Modeling Results 

### Under Sampling 

### Over Sampling 

### Combination 

# Conclusion 

# Discussion 

# References

# Acknowledgements 

The authors acknowledge financial support from the NSF HBCU-UP ACE: NSF HRD-1719498 and Research Experiences for Undergraduate Students in Data Science Analytics, National Security Agency H98230-18-1-0097. 

# Appendix 

